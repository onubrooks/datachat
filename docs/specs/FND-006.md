# FND-006: Runtime Telemetry Loops

**Initiative ID:** FND-006  
**Status:** Planned  
**Phase:** Phase A (Foundation Stabilization)  
**Last Updated:** 2026-02-20

---

## 1. Problem

Clarification churn, fallback hotspots, and low-confidence responses are not yet converted into a closed-loop improvement workflow.

## 2. Scope

In scope:

- Define telemetry events for clarification/fallback/low-confidence paths.
- Aggregate metrics by intent, source tier, and database target.
- Publish periodic hotspot reports to drive metadata and routing improvements.

Out of scope:

- Automated self-modification of prompts or routing without review.
- External BI dashboard integration in phase A.

## 3. Proposed Design

- Add structured runtime event emission across pipeline stages.
- Build hotspot aggregator jobs and report outputs.
- Tie telemetry findings to initiative backlog updates and spec revisions.

## 4. API and Contract Changes

- Define telemetry event schema and versioning strategy.
- Document metric definitions used for release decisions.

## 5. Data Model and Storage Changes

- Add telemetry event store and summarized hotspot tables.
- Capture dimensions: intent, route, source_tier, target_database, confidence.

## 6. Safety and Policy

- Prevent sensitive query text leakage in telemetry by default redaction.
- Retain only minimum fields needed for debugging and trend analysis.

## 7. Acceptance Criteria

Functional:

- [ ] Runtime emits telemetry for clarification, fallback, and low-confidence outcomes.
- [ ] Aggregation job produces weekly hotspot summaries.

Quality:

- [ ] Metric definitions are stable and documented.
- [ ] Hotspot reports correlate to reproducible query fixtures.

## 8. Test Plan

- unit: event schema validation and redaction logic tests.
- integration: pipeline run produces telemetry records and aggregate outputs.
- manual: inspect hotspot report and verify traceability to raw events.

## 9. Rollout and Rollback

Rollout:

- Start telemetry collection in non-blocking mode and validate event quality.

Rollback:

- Disable event emission by feature flag while preserving previous aggregates.

## 10. Open Questions

- What minimum confidence threshold should trigger hotspot classification?
- Which telemetry slices should be release-blocking over time?
